from pwn import *

libc = ELF('libc_32.so.6')
dubblesort = ELF('dubblesort')


class Prompts:
    NAME = 'name :'
    NUMS_COUNT = 'sort :'
    NUM = 'number : '


p = gdb.debug(
    dubblesort.path,
    '''
    b *main+0x13b
    brva 0x971
    brva 0x9a9
    c
    ''',
    env=dict(LD_PRELOAD=libc.path)
)


def main():
    num_count = 25
    p.sendlineafter(Prompts.NAME, 'egk')
    p.sendlineafter(Prompts.NUMS_COUNT, str(num_count))
    for i in range(1, num_count + 1):
        p.sendlineafter(Prompts.NUM, str(i * 4))


if __name__ == "__main__":
    main()
